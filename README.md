# Databases –∑–∞–º–µ—Ç–∫–∏

- [Databases –∑–∞–º–µ—Ç–∫–∏](#databases-–∑–∞–º–µ—Ç–∫–∏)
  - [Databases core](#databases-core)
    - [–û—Å–Ω–æ–≤—ã —Ä–∞–±–æ—Ç—ã —Å –ë–î](#–æ—Å–Ω–æ–≤—ã-—Ä–∞–±–æ—Ç—ã-—Å-–±–¥)
      - [1. üîπ –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#1--—Å–æ–∑–¥–∞–Ω–∏–µ-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
      - [2. üîπ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü](#2--—Å–æ–∑–¥–∞–Ω–∏–µ-—Ç–∞–±–ª–∏—Ü)
      - [3. üîπ –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö](#3--–æ—Å–Ω–æ–≤–Ω—ã–µ-—Ç–∏–ø—ã-–¥–∞–Ω–Ω—ã—Ö)
      - [4. üîπ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü](#4--–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è-—Ç–∞–±–ª–∏—Ü)
      - [5. üîπ –ò–Ω–¥–µ–∫—Å—ã](#5--–∏–Ω–¥–µ–∫—Å—ã)
      - [6. üîπ SELECT –∏ —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏](#6--select-–∏-—Ä–∞–±–æ—Ç–∞-—Å-–¥–∞–Ω–Ω—ã–º–∏)
        - [üîπ SELECT ‚Äî –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö](#-select--–≤—ã–±–æ—Ä–∫–∞-–¥–∞–Ω–Ω—ã—Ö)
        - [üîπ JOIN ‚Äî –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü](#-join--–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ-—Ç–∞–±–ª–∏—Ü)
        - [üîπ INSERT ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö](#-insert--–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ-–¥–∞–Ω–Ω—ã—Ö)
        - [üîπ UPDATE ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö](#-update--–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ-–¥–∞–Ω–Ω—ã—Ö)
        - [üîπ DELETE ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö](#-delete--—É–¥–∞–ª–µ–Ω–∏–µ-–¥–∞–Ω–Ω—ã—Ö)
      - [7. üîπ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏](#7--—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)

## Databases core

### –û—Å–Ω–æ–≤—ã —Ä–∞–±–æ—Ç—ã —Å –ë–î

#### 1. üîπ –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```
-- –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î
CREATE DATABASE shop;

-- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ë–î (PostgreSQL)
\c shop;

-- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ë–î (MySQL)
USE shop;
```

#### 2. üîπ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
```
CREATE TABLE users (
    id SERIAL PRIMARY KEY,        -- –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç
    name VARCHAR(100) NOT NULL,   -- —Å—Ç—Ä–æ–∫–∞ –¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤
    age INT CHECK (age > 0),      -- —á–∏—Å–ª–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º
    email VARCHAR(150) UNIQUE,    -- —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ
    created_at TIMESTAMP DEFAULT NOW()
);
```

–ü—Ä–∏–º–µ—Ä –≤—Ç–æ—Ä–æ–π —Ç–∞–±–ª–∏—Ü—ã:
```
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(id),   -- –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á
    amount DECIMAL(10,2) NOT NULL,      -- –¥–µ–Ω—å–≥–∏
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### 3. üîπ –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

**–ß–∏—Å–ª–æ–≤—ã–µ**

- `INT` / `INTEGER` ‚Äî —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
- `BIGINT` ‚Äî –±–æ–ª—å—à–∏–µ —Ü–µ–ª—ã–µ
- `SERIAL` ‚Äî –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç (PostgreSQL)
- `DECIMAL(precision, scale)` ‚Äî —Ç–æ—á–Ω—ã–µ —á–∏—Å–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –¥–µ–Ω–µ–≥)
- `FLOAT`, `REAL` ‚Äî —á–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π

**–°—Ç—Ä–æ–∫–æ–≤—ã–µ**

- `CHAR(n)` ‚Äî —Å—Ç—Ä–æ–∫–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã
- `VARCHAR(n)` ‚Äî —Å—Ç—Ä–æ–∫–∞ –¥–æ n —Å–∏–º–≤–æ–ª–æ–≤
- `TEXT` ‚Äî –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç

**–î–∞—Ç—ã –∏ –≤—Ä–µ–º—è**

- `DATE` ‚Äî —Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞
- `TIME` ‚Äî —Ç–æ–ª—å–∫–æ –≤—Ä–µ–º—è
- `TIMESTAMP` ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è
- `NOW()` ‚Äî —Ç–µ–∫—É—â–∏–µ –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è

**–õ–æ–≥–∏—á–µ—Å–∫–∏–µ**

- `BOOLEAN` ‚Äî true/false

**–ü—Ä–æ—á–µ–µ**

- `UUID` ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `JSON` / `JSONB` (PostgreSQL) ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ JSON

#### 4. üîπ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü
```
-- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É
ALTER TABLE users ADD COLUMN phone VARCHAR(20);

-- –£–¥–∞–ª–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É
ALTER TABLE users DROP COLUMN phone;

-- –ò–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø
ALTER TABLE users ALTER COLUMN age TYPE SMALLINT;
```

#### 5. üîπ –ò–Ω–¥–µ–∫—Å—ã

–£—Å–∫–æ—Ä—è—é—Ç –ø–æ–∏—Å–∫, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º –∏ JOIN.
```
-- –ò–Ω–¥–µ–∫—Å –ø–æ email
CREATE INDEX idx_users_email ON users(email);

-- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å
CREATE UNIQUE INDEX uniq_users_name ON users(name);
```

#### 6. üîπ SELECT –∏ —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

##### üîπ SELECT ‚Äî –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

- –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```
SELECT —Å—Ç–æ–ª–±—Ü—ã
FROM —Ç–∞–±–ª–∏—Ü–∞
WHERE —É—Å–ª–æ–≤–∏–µ
ORDER BY –ø–æ–ª–µ [ASC|DESC]
LIMIT n OFFSET m;
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```
-- –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏
SELECT * FROM users;

-- –û–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
SELECT id, name FROM users;

-- –° —Ñ–∏–ª—å—Ç—Ä–æ–º
SELECT id, name FROM users WHERE age > 18;

-- –° —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
SELECT id, name FROM users ORDER BY age DESC;

-- –° –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
SELECT id, name FROM users LIMIT 10 OFFSET 20;
```

##### üîπ JOIN ‚Äî –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–≤—è–∑–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü.

**–í–∏–¥—ã JOIN:**

1. **INNER JOIN** ‚Äî —Ç–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è.
2. **LEFT JOIN** ‚Äî –≤—Å–µ –∏–∑ –ª–µ–≤–æ–π + —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–∑ –ø—Ä–∞–≤–æ–π.
3. **RIGHT JOIN** ‚Äî –≤—Å–µ –∏–∑ –ø—Ä–∞–≤–æ–π + —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–∑ –ª–µ–≤–æ–π.
4. **FULL JOIN** ‚Äî –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü.

**–ü—Ä–∏–º–µ—Ä—ã:**
```
-- INNER JOIN
SELECT u.id, u.name, o.amount
FROM users u
INNER JOIN orders o ON u.id = o.user_id;

-- LEFT JOIN
SELECT u.id, u.name, o.amount
FROM users u
LEFT JOIN orders o ON u.id = o.user_id;

-- RIGHT JOIN
SELECT u.id, u.name, o.amount
FROM users u
RIGHT JOIN orders o ON u.id = o.user_id;

-- FULL JOIN (–Ω–µ –≤—Å–µ–≥–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ MySQL)
SELECT u.id, u.name, o.amount
FROM users u
FULL JOIN orders o ON u.id = o.user_id;
```

##### üîπ INSERT ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—É.

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```
INSERT INTO —Ç–∞–±–ª–∏—Ü–∞ (–∫–æ–ª–æ–Ω–∫–∏) VALUES (–∑–Ω–∞—á–µ–Ω–∏—è);
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```
-- –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
INSERT INTO users (name, age) VALUES ('Alice', 25);

-- –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
INSERT INTO users (name, age) VALUES ('Bob', 30), ('Charlie', 28);
```

##### üîπ UPDATE ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ò–∑–º–µ–Ω—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏.

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```
UPDATE —Ç–∞–±–ª–∏—Ü–∞ SET –ø–æ–ª–µ = –∑–Ω–∞—á–µ–Ω–∏–µ WHERE —É—Å–ª–æ–≤–∏–µ;
```

‚ö†Ô∏è –ë–µ–∑ WHERE –æ–±–Ω–æ–≤—è—Ç—Å—è –≤—Å–µ —Å—Ç—Ä–æ–∫–∏.

**–ü—Ä–∏–º–µ—Ä—ã:**
```
-- –ò–∑–º–µ–Ω–∏—Ç—å –≤–æ–∑—Ä–∞—Å—Ç
UPDATE users SET age = 26 WHERE name = 'Alice';

-- –£–≤–µ–ª–∏—á–∏—Ç—å –≤–æ–∑—Ä–∞—Å—Ç –≤—Å–µ–º
UPDATE users SET age = age + 1;
```

##### üîπ DELETE ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–£–¥–∞–ª—è–µ—Ç —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```
DELETE FROM —Ç–∞–±–ª–∏—Ü–∞ WHERE —É—Å–ª–æ–≤–∏–µ;
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```
-- –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
DELETE FROM users WHERE id = 1;

-- –£–¥–∞–ª–∏—Ç—å –≤—Å–µ—Ö
DELETE FROM users;
```

#### 7. üîπ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è = –Ω–∞–±–æ—Ä SQL-–æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–∞—Ç–æ–º–∞—Ä–Ω–æ**.
–õ–∏–±–æ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è (COMMIT), –ª–∏–±–æ –Ω–∏ –æ–¥–Ω–æ (ROLLBACK).

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```
BEGIN;            -- –Ω–∞—á–∞–ª–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;           -- —Ñ–∏–∫—Å–∞—Ü–∏—è
-- ROLLBACK;      -- –æ—Ç–º–µ–Ω–∞ (–µ—Å–ª–∏ –æ—à–∏–±–∫–∞)
```

**–ü—Ä–∏–º–µ—Ä —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º –¥–µ–Ω–µ–≥:**

```
BEGIN;

UPDATE accounts SET balance = balance - 200 WHERE id = 1;
UPDATE accounts SET balance = balance + 200 WHERE id = 2;

COMMIT;
```